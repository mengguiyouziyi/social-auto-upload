# See https://pre-commit.com for more information
# See https://pre-commit.com/hooks.html for more hooks
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
      - id: check-merge-conflict
      - id: debug-statements
      - id: check-docstring-first
      - id: check-json
      - id: check-toml
      - id: check-xml
      - id: check-yaml
      - id: detect-private-key

  - repo: https://github.com/psf/black
    rev: 23.12.1
    hooks:
      - id: black
        language_version: python3
        args: ['--line-length=88']

  - repo: https://github.com/pycqa/isort
    rev: 5.13.2
    hooks:
      - id: isort
        args: ['--profile', 'black', '--line-length', '88']

  - repo: https://github.com/pycqa/flake8
    rev: 6.1.0
    hooks:
      - id: flake8
        args: ['--max-line-length=88', '--extend-ignore=E203,W503']

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.8.0
    hooks:
      - id: mypy
        additional_dependencies: [types-requests, types-Flask]
        args: [--ignore-missing-imports]

  - repo: https://github.com/pycqa/bandit
    rev: 1.7.5
    hooks:
      - id: bandit
        args: ['-r', '-f', 'json', '-o', 'bandit-report.json']

  - repo: https://github.com/Lucas-C/pre-commit-hooks-safety
    rev: v1.3.2
    hooks:
      - id: python-safety-dependencies-check
        files: requirements.*\.txt$

  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.9.0.2
    hooks:
      - id: shellcheck
        args: ['-e', 'SC1091']

  - repo: https://github.com/adrienverge/yamllint
    rev: v1.35.1
    hooks:
      - id: yamllint
        args: ['-d', 'relaxed']

  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v8.56.0
    hooks:
      - id: eslint
        files: \.(js|vue|ts)$
        types: [file]
        additional_dependencies:
          - eslint@8.56.0
          - eslint-plugin-vue@9.19.2
          - @typescript-eslint/eslint-plugin@6.17.0
          - @typescript-eslint/parser@6.17.0
        args: ['--fix', '--max-warnings=0']

  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.1.2
    hooks:
      - id: prettier
        types_or: [yaml, markdown, json, javascript, vue]
        args: ['--write', '--tab-width=2']

  - repo: https://github.com/pycqa/docformatter
    rev: v1.7.5
    hooks:
      - id: docformatter
        args: ['--in-place', '--wrap-summaries=72', '--wrap-descriptions=72']

  - repo: local
    hooks:
      - id: pytest-check
        name: pytest-check
        entry: pytest
        language: system
        pass_filenames: false
        always_run: true
        args: [tests/, --tb=short]

      - id: security-check
        name: security-check
        entry: safety
        language: system
        files: requirements.*\.txt$
        pass_filenames: false
        args: [check]

# 排除某些文件和目录
exclude: |
    (?x)^(
        venv/.*|
        \.venv/.*|
        __pycache__/.*|
        .*\.egg-info/|
        build/|
        dist/|
        sau_frontend/node_modules/|
        sau_frontend/dist/|
        sau_frontend/\.vite/|
        \.git/|
        \.tox/|
        \.coverage|
        htmlcov/|
        .*\.pyc|
        .*\.pyo|
        .*\.pyd|
        .*\.so|
        .*\.dll|
        .*\.dylib|
        .*\.exe|
        .*\.bin|
        .*\.log|
        .*\.tmp|
        .*\.temp|
        .*\.cache|
        .*\.DS_Store|
        sau_frontend/coverage/|
        sau_backend/migrations/|
        uploads/|
        logs/|
        cookies/|
        \.env.*|
        \.secret|
        \.key|
        \.pem|
        \.crt|
        \.csr|
        .*\.jks|
        .*\.keystore|
        .*\.p12|
        .*\.pfx|
        .*\.sqlite3|
        .*\.db|
        .*\.bak|
        .*\.backup|
        .*\.swp|
        .*\.swo|
        .*~|
        \#.*\#|
        .*\.orig|
        .*\.rej|
        .*\.pb\.user|
        .*\.suo|
        .*\.user|
        .*\.userosscache|
        .*\.sln\.docstates|
        .*\.ntvs_analysis|
        .*\.vscode/|
        .*\.idea/|
        .*\.vs/
    )$